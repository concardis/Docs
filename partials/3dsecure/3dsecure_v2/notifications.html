
<ul>
  <li><a href="/3dsecure/3dsecure_v2_notifications#introduction" name="">Introduction</a></li>
  <li><a href="/3dsecure/3dsecure_v2_notifications#parameters">Parameters</a></li>
  <li><a href="/3dsecure/3dsecure_v2_notifications#subscription">Subscription</a>
    <ul>
      <li><a href="/3dsecure/3dsecure_v2_notifications#subscriptionViaMerchantCenter">Subscription via Merchant Center</a></li>
      <li><a href="/3dsecure/3dsecure_v2_notifications#subscriptionViaAPI">Subscription via API</a></li>
    </ul>
  </li>
</ul>

<div id="introduction">
  <br/>
  <br/>
  <h2>Introduction</h2>
  <br/>
  <br/>
  <p>In order to notifiy merchants about the results of the 3DS authentication, e.g. if a challenge is finished, a new notification event is required.</p>
  <br/>
  <p>This event will only be supported for the Payengine Notifications Version 2 and is only available via the Webhook.</p>
  <br/>
    <table border="1px solid black" class="table table-bordered table-striped table-condensed" width="500px;">
      <thead>
        <tr>
          <th  width="200px;">Event</th>
          <th  width="200px;" style="background-color:#dfe1e8;">Webhook</th>
          <th  width="200px;" style="background-color:#dfe1e8;">Email</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>3ds.result</td>
          <td>yes</td>
          <td>no</td>
        </tr>
      </tbody>
    </table>
  <br/>
  <br/>
  <p>Further information about the Notification feature can be found <a href="/notifications">[PubDoc] Notifications</a>.</p>
</div>
<br/>
<div id="parameters">
  <br/>
  <h2>Parameters</h2>
  <br/>
  <br/>
  <p>The new 3ds.result event will contain the following parameters.</p>
  <br/>
    <table border="1px solid black" class="table table-bordered table-striped table-condensed" width="500px;">
      <thead>
        <tr>
          <th  width="100px;">Parameters</th>
          <th  width="200px;">Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>notificationApiVersion</td>
          <td>version of the notification service, always set to "2.0"</td>
        </tr>
        <tr>
          <td>notificationId</td>
          <td>Payengine notification identifier</td>
        </tr>
        <tr>
          <td>globalTrackId</td>
          <td>Payengine global tracking id (for debugging)</td>
        </tr>
        <tr>
          <td>eventType</td>
          <td>Type of the event, e.g. trx.debit.success</td>
        </tr>
        <tr>
          <td>createdAt</td>
          <td>Timestamp of the event</td>
        </tr>
        <tr>
          <td>merchantId</td>
          <td>Payengine merchantId</td>
        </tr>
        <tr>
          <td>threeAuthenticationId</td>
          <td>Identifier of the 3DS authentication transaction generated by the Payengine if transaction was triggered through dedicated authentication service</td>
        </tr>
        <tr>
          <td>orderData</td>
          <td>Order object in case the authentication was triggered as part of an order</td>
        </tr>
        <tr>
          <td>orderData.transactionId</td>
          <td>Payengine transactionId</td>
        </tr>
        <tr>
          <td>orderData.orderId</td>
          <td>Payengine orderId</td>
        </tr>
        <tr>
          <td>orderData.merchantOrderId</td>
          <td>Merchant order reference</td>
        </tr>
        <tr>
          <td>authenticationResult</td>
          <td>Object containing the result of the 3DS authentication transaction (final results will be available only in case of frictionless flow)</td>
        </tr>
        <tr>
          <td>authenticationResult.version</td>
          <td>Parameter indicating the version of the 3DS<br/>1.0 or 2.0</td>
        </tr>
        <tr>
          <td>authenticationResult.status</td>
          <td>
            Enum:"Y" "N" "A" "U" "R"<br/><br/>
            Indicates whether a transaction qualifies as an authenticated transaction or account verification.<br/><br/>
            Y = authentication successful<br/>
            N = not authenticated; transaction denied<br/>
            U = authentication could not be performed; technical or other problem<br/>
            A = attempts processing performed; not attempted<br/>
            R = authentication rejected; issuer is rejecting
          </td>
        </tr>
        <tr>
          <td>authenticationResult.transactionId</td>
          <td>The transaction identifier from the 3DS authentication 3DS 1.0: This will be the XID 3DS 2.0: This will be the dsTransID</td>
        </tr>
        <tr>
          <td>authenticationResult.authenticationValue</td>
          <td>The authenticationValue returned in the 3DS authentication CAVV: Visa, AMEX, JCB, Diners/Discover UCAF: Mastercard</td>
        </tr>
        <tr>
          <td>authenticationResult.eci</td>
          <td>
            The Electronic Commerce Indicator (ECI) provided by the ACS or DS to indicate the results of the attempt to authenticate the cardholder. The ECI values might differ depending on the card scheme.<br/>
            For all fully authenticated or authentication attempted transactions the liability will be shifted to the card issuer.<br/><br/>
            Mastercard<br/>
              00 - no authentication available<br/>
              01 - authentication attempted<br/>
              02 - fully authenticated<br/>
              07 - fully authenticated*<sup>1</sup><br/><br/>
            All other card schemes<br/>
              05 - fully authenticated<br/>
              06 - authentication attempted<br/>
              07 - no authentication available<br/><br/>
            *<sup>1</sup> - Mastercard distinguishes between fully authenticated recurring payments (flagged with ECI 07) and all other fully authenticated transactions (flagged with ECI 02).
          </td>
        </tr>
        <tr>
          <td>authenticationResult.errorDetails</td>
          <td>Object containing error information in case of error</td>
        </tr>
        <tr>
          <td>authenticationResult.errorDetails.providerCode</td>
          <td>Original error code from the 3ds server or mpi</td>
        </tr>
        <tr>
          <td>authenticationResult.errorDetails.providerMessage</td>
          <td>Original error message from the 3ds server or mpi</td>
        </tr>
        <tr>
          <td>type</td>
          <td>
            Enum:"PAYMENT_TRANSACTION" "RECURRING_TRANSACTION" "RECURRING_CARDCHECK""ADD_CARD"<br/><br/>
            The type of the authentication requested. <br/><br/>
            PAYMENT_TRANSACTION: authentication with payment; the authentication is used for a normal payment transaction,<br/>
            RECURRING_TRANSACTION: authentication with payment; the authentication is used for an initial recurring payment transaction,<br/>
            RECURRING_CARDCHECK: authentication without payment; the authentication is used for a card check representing the initial recurring payment transaction,<br/>
            ADD_CARD: authentication without payment; the authentication is only used for the verification of stored card credentials, e.g. within a wallet
          </td>
          <tr>
            <td>paymentInstrumentId</td>
            <td>Identifier of the payment instrument used for the 3DS authentication.</td>
          </tr>
        </tr>
      </tbody>
    </table>
    <br/>
    <br/>
    <table border="1px solid black" class="table table-bordered table-striped table-condensed" width="500px;">
      <thead>
        <tr>
          <td>
            <p>Sample 3ds.result event message</p>
          </td>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
              <code>
                  {
                    "notificationApiVersion": "2.0",
                    "notificationId": "notification_ewnozkeo6z",
                    "globalTrackId": "XLg5rFkDCps-XAAa-qpMuwAAAAQ",
                    "eventType": "3ds.result",
                    "createdAt": 1555577260745,
                    "merchantId": "merchant2",
                    "threeAuthenticationId": ,
                    "orderData": {
                      "transactionId": "transaction_eyn7mnrpkf",
                      "orderId": "jow94tbrwj",
                      "merchantOrderId": "merchantOrderId_49489392"
                    },
                    "authenticationResult": {
                      "version": "2.0",
                      "status": "Y",
                      "transactionId": "60e15ea6-98df-11e9-a2a3-2a2ae2dbcce4",
                      "authenticationValue": "YXV0aGVudGljYXRpb25WYWx1ZQ==",
                      "eci": "05",
                      "errorDetails": {
                          "providerCode": null,
                          "providerMessage": null
                      }
                    },
                    "type": "PAYMENT_TRANSACTION",
                    "paymentInstrumentId": "paymentinstrument_sit9uglw7r"
                  }
                </code>
          </td>
        </tr>
      </tbody>
    </table>
<br/>
</div>
<br/>
<div id="subscription">
  <br/>
  <h2>Subscription</h2>
  <br/>
  <br/>
  <p>You can subscribe for a 3ds.result event either via Merchant Center configuration or via the API in the corresponding preauth or debit request.</p>
  <br/>
  <br/>
  <div id="subscriptionViaMerchantCenter">
    <h3 >Subscription via Merchant Center</h3>
    <br/>
    <br/>
    <p>The subscription of the <em>3ds.result</em> event can be enabled in Notification settings in the Merchant Center.</p>
    <br/>
    <p>The event will only be available for <em>Notification Type=URL</em> and <em>Version=V2.</em></p>
  </div>
  <br/>
  <br/>
  <div id="subscriptionViaAPI">
    <br/>
    <h3>Subscription via API</h3>
    <br/>
    <br/>
    <p>The subscription of the <em>3ds.result</em> event can be enabled via the API as part of the async.notifications-object in a preauth or debit request. </p>
    <br/>
    <br/>
    <table border="1px solid black" class="table table-bordered table-striped table-condensed" width="500px;">
        <thead>
          <tr>
            <td>
              <p>Sample 3ds.result event message</p>
            </td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <code>
                "async": {
                  "notificationUrl": "https://{someurl}",
                  "successUrl": "https://my.success.url",
                  "failureUrl": "https://my.failure.url"
                }
              </code>
            </td>
          </tr>
        </tbody>
      </table>
  </div>
</div>
