
<br/>
<div>
	<h2>Overview</h2>
	<br/>
	<p>
		<strong>Alipay</strong> is a third-party mobile and online payment platform. It is the world's number one mobile payment service organization and the second largest mobile payment service organization in the world.
	</p>
	<br/>
	<p>
		Alipay operates with more than 65 financial institutions including Visa and MasterCard to provide payment services for Taobao and Tmall as well as more than 460,000 online and local Chinese businesses.
	</p>
	<br/>
	<p>
		Alipay provides multiple security mechanisms to make sure that user accounts are safe. An Alipay account requires the user to set up their own login password and separate payment password, which need to be different. The user can enter the login password up to five times and the payment password up to three times before the user is locked out of his or her account. To regain access to the account, the user must contact Alipay. A user must also install a digital certificate, which can encrypt information sent over a network, preventing hackers from stealing passwords, thereby enhancing the security of online transactions.
	</p>
	<br/>
	<br/>
	<h2>CUSTOMER EXPERIENCE</h2>
	<br/>
	<p>
		In the Payengine Modal Widget the selection of the payment method and account holder look as per following screens.
	</p>
	<br/>
	<table border="1" width="60%">
		<thead>
			<th>Step</th>
			<th>Description</th>
			<th >Screenshot</th>
		</thead>
		<tr>
			<td>
				1
			</td>
			<td>
				Select Alipay
			</td>
			<td>
				<img class="" src="/img/faq/alipay/alipay_widget_1.png" width="100%" />
			</td>
		</tr>
		<tr>
			<td>
				2
			</td>
			<td>
				Edit Account holder
			</td>
			<td>
				<img class="" src="/img/faq/alipay/alipay_widget_2.png" width="100%" />
			</td>
		</tr>
		<tr>
			<td>
				3
			</td>
			<td>
				Redirect to Alipay login page
			</td>
			<td>
				<img class="" src="/img/faq/alipay/alipay.png" width="100%" />
			</td>
		</tr>
	</table>
	<br/>
	<p>
		In his online Bank Account, following the steps, he can pay for his purchase:
	</p>
	<br/>

	<h2>Payengine Details</h2>
	<br/>
	<div>
		<div class="content-box-wrapper">
			<div class="pricing-box-alt row clearfix">
				<div class="col-md-3 plans-features">
					<ul>
						<li class="header ms-hover"><strong>General</strong></li>
						<li class="ms-hover">Product</li>
						<li class="ms-hover">Type</li>
						<li class="ms-hover">Channels</li>
						<li class="ms-hover">Currencies</li>
						<li class="ms-hover">Countries</li>
						<li class="ms-hover">Technical Flow</li>
						<li class="ms-hover">Recurring</li>
						<li class="ms-hover">Chargebacks</li>
					</ul>
				</div>
				<div class="individual-plan">
					<ul>
						<li class="header ms-hover"></li>
						<li class="ms-hover">Alipay</li>
						<li class="ms-hover">sepa</li>
						<li class="ms-hover">ecom</li>
						<li class="ms-hover">AUD, CAD, EUR, GBP, HKD, SGD, USD</li>
						<li class="ms-hover">crossborder</li>
						<li class="ms-hover">asynchronous</li>
						<li class="ms-hover">no</li>
						<li class="ms-hover">no</li>
					</ul>
				</div>
			</div>
		</div>
		<br/>
		<br/>
		<div class="content-box-wrapper">
			<div class="pricing-box-alt row clearfix">
				<div class="col-md-3 plans-features">
					<ul>
						<li class="header ms-hover"><strong>Supported Features</strong></li>
						<li class="header ms-hover"><strong>& Services</strong></li>
						<li class="ms-hover">Debit</li>
						<li class="ms-hover">Preauthorization</li>
						<li class="ms-hover">Cancelation</li>
						<li class="ms-hover">Capture</li>
						<li class="ms-hover">Refunds</li>
						<li class="ms-hover">Notifications</li>
						<li class="ms-hover">Settlement Reporting</li>
					</ul>
				</div>
				<div class="individual-plan">
					<ul>
						<li class="header ms-hover"></li>
						<li class="header ms-hover"></li>
						<li class="ms-hover">yes</li>
						<li class="ms-hover">no</li>
						<li class="ms-hover">no</li>
						<li class="ms-hover">no</li>
						<li class="ms-hover">yes</li>
						<li class="ms-hover">yes - webhook, email</li>
						<li class="ms-hover">yes - unified settlement reporting</li>
					</ul>
				</div>
			</div>
		</div>
		<br/>
		<br/>
		<div class="content-box-wrapper">
			<div class="pricing-box-alt row clearfix">
				<div class="col-md-3 plans-features">
					<ul>
						<li class="header ms-hover"><strong>Integration Types</strong></li>
						<li class="ms-hover">API</li>
						<li class="ms-hover">Widget</li>
						<li class="ms-hover">Bridge</li>
						<li class="ms-hover">Shop Plugin</li>
					</ul>
				</div>
				<div class="individual-plan">
					<ul>
						<li class="header ms-hover"><strong></strong></li>
						<li class="ms-hover">yes</li>
						<li class="ms-hover">yes</li>
						<li class="ms-hover">no</li>
						<li class="ms-hover">no</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
	<br/>
	<h2>Technical Flow</h2>
	<br/>
	<h3>Step 1: Set credentials</h3>
	<br/>
	<p>
		Alipay payment method is available trough PPRO Payment Platform. For this reason, the merchant must have his own PPRO account. He must contact the merchant center administrator to provide his PPRO settings.
	</p>
	<br/>
	<p>
		PPRO SETTINGS PER MERCHANT
	</p>
	<br/>
	<table border="1">
		<thead>
			<th>Field</th>
			<th>Description</th>
		</thead>
		<tr>
			<td>
				Contract ID
			</td>
			<td>
				should be provided by the PPRO
			</td>
		</tr>
		<tr>
			<td>
				Shared Secret
			</td>
			<td>
				should be provided by the PPRO
			</td>
		</tr>
		<tr>
			<td>
				Notification Secret
			</td>
			<td>
				should be provided by the PPRO
			</td>
		</tr>
	</table>

	<br/>
	<h3>Step 2: Create debit</h3>
	<br/>
	<p>
		Once the Customer chooses Alipay payment, he will be transferred to Alipay login page to proceed with the payment. The debit causes the immediately charging of the full amount.
	</p>
	<br/>
	<p>
		<img class="" src="/img/faq/alipay/alipay_flow.png" width="100%" />
	</p>
	<br/>

	<br/>
	<h3>Step 3: Confirm that the charge has succeeded</h3>
	<br/>
	<p>
		As it is not ensured at the time of the redirect to the shop that the payment was 100% successful the Payengine waits for the final asynchronous notification from the bank before a status is moved from PENDING into SUCCESS or FAILURE.
	</p>
	<br/>
	<h4>Webhook notifications</h4>
	<br/>
	<p>
		A merchant should register for the Payengine webhook notifications in order to receive this final status update. A GET on the order or DEBIT transaction would also work, but it is not ensured that the final status will be available immediately after the redirect and a merchant might have to query the GET multiple times. Therefore it is strongly recommended that the asynchronous notifications from the Payengine are used insetad.
	</p>
	<br/>
	<p>
		The Alipay notifications could be subscribed.
	</p>
	<ul>
		<li>via the payengine API
			<a href="https://docs.payengine.de/buildyourown/restapi">
			(Link to API documentation)
			</a>
	</li>
		<li>via the Payengine merchant center
			<a href="https://docs.payengine.de/merchantcenter/notifications_mc">
			(Link to Merchant Center notifications documentation)
			</a>
		</li>
	</ul>
	<br/>
	<p>
		The following events have to be subscribed for in order to receive the Alipay notifications, depending on the preferred source of notification.
	</p>
	<br/>
	<table border="1">
		<thead>
			<th>Source</th>
			<th>Event</th>
		</thead>
		<tr>
			<td>
				API
			</td>
			<td>
				notificationState = UPDATED
			</td>
		</tr>
		<tr>
			<td>
				Merchant Center
			</td>
			<td>
				<table>
				<tr>
					<td>
						event type = order update success
					</td>
				</tr>
				<tr>
					<td>
						event type = order update failure
					</td>
				</tr>
				</table>
			</td>
		</tr>
	</table>
	<br/>
	<h4>Merchant center view of order</h4>
	<br/>
	<p>
		When the order is created the merchant can view order's details in Merchant center:
	</p>
	<br/>
	<p>
		<img class="" src="/img/faq/alipay/alipay_view.png" width="100%" />
	</p>

	<br/>
	<br/>
	<h3>Step 4: Refund transaction amount</h3>
	<br/>
	<p>
		If the transaction is with status SUCCESS, merchant can refunt full or partial amount of the transaction.
	</p>
	<br/>
	<p>
		Select SUCCESS transaction from transactions list, and you will see Refund button above the transaction details.
	</p>
	<br/>
	<p>
		<img class="" src="/img/faq/alipay/alipay_refund_1.png" width="100%" />
	</p>
	<br/>
	<p>
		When merchant click on the 'Refund' button, it will open new window with the details for refund.
	</p>
	<br/>
	<p>
		<strong>Note:</strong> Merchant can refund full or partial amount of the transaction. If the merchant refund full amount the transaction 'Refund' button will disappear from transaction details. In the other case the merchant can refund rest of the amount later.
	</p>
	<br/>
	<p>
		<img class="" src="/img/faq/alipay/alipay_refund_2.png" width="100%" />
	</p>
	<br/>
	<p>
		When merchant refund all or part of the transaction amount, new transaction will appear in transaction details with type REFUND. Merchant can view refund transaction details in the left pane.
	</p>
	<br/>
	<p>
		<img class="" src="/img/faq/alipay/alipay_refund_3.png" width="100%" />
	</p>
	<br/>
	<br/>
	<div>
		<br/>
		<h2>Specifics</h2>
		<br/>
		<h3>Alipay input parameters</h3>
		<br/>
		<p>The following input parameters are required for initiating an Alipay payment via direct API integration.</p>
		<br/>
		<table border="1">
			<tr>
				<td >
					PARAMETER
				</td>
				<td >
					MANDATORY/OPTIONAL
				</td>
				<td >
					DESCRIPTION
				</td>
				<td >
					EXAMPLE
				</td>
			</tr>
			<tr>
				<td>
					payment.accountHolder
				</td>
				<td>
					M
				</td>
				<td>
					Name of the bank account holder
				</td>
				<td>
					John Doe
				</td>
			</tr>
			<tr>
				<td>
					payment.successUrl
				</td>
				<td>
					M
				</td>
				<td>
					Redirect URL for successful payment
				</td>
				<td>
					http://my.shop.com/success
				</td>
			</tr>
			<tr>
				<td>
					payment.failureUrl
				</td>
				<td>
					M
				</td>
				<td>
					Redirect URL for unsuccessful payment
				</td>
				<td>
					http://my.shop.com/fail
				</td>
			</tr>
			<tr>
				<td>
					payment.cancelUrl
				</td>
				<td>
					M
				</td>
				<td>
					Redirect URL when payment is canceled
				</td>
				<td>
					http://my.shop.com/cancel
				</td>
			</tr>
		</table>
		<br/>

	<div>
		<br/>
		<h2>Samples</h2>
		<br/>
		<p>Alipay debit endpoint: </p>
		<br/>
		<p>/orders/debit </p>
		<br/>
		<div class="example-box-wrapper">
			<div class="content-box" ng-init="createCustomerRequestShow=false">
				<h3 class="content-box-header bg-default">
						Alipay Debit request
						<div class="header-buttons-separator">
								<a href class="icon-separator toggle-button" ng-click="createCustomerRequestShow!=createCustomerRequestShow; console.log(createCustomerRequestShow)">
									<!-- <i class="glyph-icon icon-chevron-up"></i> -->
									<i class="glyph-icon icon-chevron-up" ng-if="createCustomerRequestShow"></i>
									<i class="glyph-icon icon-chevron-down" ng-if="!createCustomerRequestShow"></i>
								</a>
						</div>
				</h3>
				<!-- <div class="content-box-wrapper" ng-if="createCustomerRequestShow"> -->
				<div class="content-box-wrapper">
					<code>
{
  "product" : "Alipay",
  "terms": 1468590412476,
  "privacy": 1468590412476,
  "merchantOrderId": "merchantOrderId1549459331",
  "description": "test transaction",
  "statementDescription": "statement description",
  "initialAmount": 1190,
  "currency": "EUR",
  "basket": [
    {
      "name": "USB-Stick ",
      "articleNumber": "SW10029",
      "totalPrice": 1000,
      "totalPriceWithTax": 1190,
      "unitPrice": 100,
      "unitPriceWithTax": 119,
      "tax": 19,
      "quantity": 10
    }
  ],
  "customer": "customer_l2r3w5ztzb",
  "persona": "persona_s7plfnwiuo",
  "billingAddress": "address_htxg2ezmjq",
  "shippingAddress": "address_htxg2ezmjq",
  "ipAddress": "82.120.21.79",
  "channel": "ECOM",
  "source": "Test",
  "async": {
    "successUrl": "https://www.google.de/#newwindow=1&q=success",
    "failureUrl": "https://www.google.de/#newwindow=1&q=failure",
    "cancelUrl": "https://www.google.de/#newwindow=1&q=cancel"
  }
}
					</code>
				</div>
			</div>
		</div>
		<br/>
		<br/>
		<p>Refund endpoint: </p>
		<br/>
		<p>/orders/{orderId}/transactions/{transactionId}/refund </p>
		<div class="example-box-wrapper">
			<div class="content-box" ng-init="createCustomerResponseShow=false">
				<h3 class="content-box-header bg-default">
						Alipay refund request
						<div class="header-buttons-separator">
								<a href class="icon-separator toggle-button" ng-click="createCustomerResponseShow!=createCustomerResponseShow; console.log(createCustomerResponseShow)">
									<!-- <i class="glyph-icon icon-chevron-up"></i> -->
									<i class="glyph-icon icon-chevron-up" ng-if="createCustomerResponseShow"></i>
									<i class="glyph-icon icon-chevron-down" ng-if="!createCustomerResponseShow"></i>
								</a>
						</div>
				</h3>
				<!-- <div class="content-box-wrapper" ng-if="createCustomerRequestShow"> -->
				<div class="content-box-wrapper">
					<code>
{
  "initialAmount": 500,
  "currency": "EUR",
  "description": "string",
  "basket": [
    {
      "name": "USB-Stick 1541107031",
        "articleNumber": "SW10029",
        "totalPrice": 1000,
        "totalPriceWithTax": 1190,
        "unitPrice": 100,
        "unitPriceWithTax": 119,
        "quantity": 10,
        "tax": 19,
        "discount": null
    }
  ]
}
					</code>
				</div>
			</div>
		</div>


	</div>
	<div>
		<br/>
		<h2>Settlements</h2>
		<br/>
		<p>All settlement information will be provided in the Unified Settlement Report. The format and mappings can be found in the corresponding documentation (see
			<a href="https://docs.payengine.de/merchantcenter/settlement_report">
				Unified Settlement Report
			</a>
			).
		</p>
	</div>
</div>
